<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Actions Dividendes - Rente Passive</title>
    <style>
        /* Styles CSS pour l'esth√©tique du tableau */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f9;
        }
        .container {
            max-width: 1000px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
        }
        #dividend-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        #dividend-table th, #dividend-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        #dividend-table th {
            background-color: #3498db;
            color: white;
            cursor: pointer; /* Pour le tri */
        }
        #dividend-table tr:hover {
            background-color: #ecf0f1;
        }
        .loading {
            text-align: center;
            padding: 50px;
            color: #7f8c8d;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>üìä Cash Dividende Votre Partenaire </h1>
        <p>Donn√©es mises √† jour suite au T3 2025.</p>
        
        <div id="loading-message" class="loading">Chargement des donn√©es...</div>

        <table id="dividend-table">
            <thead>
                <tr>
                    <th data-column="ticker">TICKET üîº</th>
                    <th data-column="nom">Soci√©t√©</th>
                    <th data-column="secteur">Secteur</th>
                    <th data-column="cours">Cours USD</th>
                    <th data-column="rendement">Rendement %</th>
                    <th data-column="dividende">Dividende USD</th>
                </tr>
            </thead>
            <tbody>
                </tbody>
        </table>
    </div>

    <script>
        // Le code JavaScript pour r√©cup√©rer et afficher les donn√©es
        
        // ATTENTION : REMPLACEZ CETTE CHA√éNE PAR L'URL DE VOTRE APPLICATION WEB GOOGLE SCRIPT
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbz0ezTUoxREg2tuycIe5kkBZaWB4e7eRFxVIqJDlwwYiYdNAecOuS_Rm0ld2yWuiFGifw/exec'; // <-- MODIFIEZ MOI

        let currentData = [];
        let sortColumn = 'ticker';
        let sortDirection = 1; // 1 pour ASC (croissant), -1 pour DESC (d√©croissant)

        // Fonction principale pour r√©cup√©rer les donn√©es du script
        async function fetchDividendData() {
            try {
                const response = await fetch(SCRIPT_URL);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                currentData = await response.json();
                renderTable(); // Affiche et trie le tableau initial
                document.getElementById('loading-message').style.display = 'none'; // Cache le message de chargement
            } catch (error) {
                console.error("Erreur lors de la r√©cup√©ration des donn√©es :", error);
                document.getElementById('loading-message').textContent = "Erreur de chargement. V√©rifiez l'URL de l'API.";
            }
        }

        // Fonction pour trier les donn√©es
        function sortData() {
            currentData.sort((a, b) => {
                const valA = a[sortColumn];
                const valB = b[sortColumn];

                if (typeof valA === 'string') {
                    return valA.localeCompare(valB) * sortDirection;
                }
                return (valA - valB) * sortDirection;
            });
        }

        // Fonction pour dessiner le tableau dans le HTML
        function renderTable() {
            sortData(); // Trie les donn√©es avant l'affichage
            const tbody = document.getElementById('dividend-table').getElementsByTagName('tbody')[0];
            tbody.innerHTML = ''; // Vide le tableau existant

            currentData.forEach(item => {
                const row = tbody.insertRow();
                
                row.insertCell().textContent = item.ticker;
                row.insertCell().textContent = item.nom;
                row.insertCell().textContent = item.secteur;
                
                // Formatage des nombres
                row.insertCell().textContent = item.cours.toFixed(2) + ' $';
                row.insertCell().textContent = (item.rendement * 100).toFixed(2) + ' %';
                row.insertCell().textContent = item.dividende.toFixed(2) + ' $';
            });

            // Met √† jour les fl√®ches de tri
            document.querySelectorAll('#dividend-table th').forEach(th => {
                const column = th.getAttribute('data-column');
                let symbol = '';
                if (column === sortColumn) {
                    symbol = sortDirection === 1 ? ' üîº' : ' üîΩ';
                }
                th.textContent = th.textContent.replace(/ [‚ñ≤‚ñº].*/, '') + symbol;
            });
        }

        // Gestionnaire d'√©v√©nements pour le tri par colonne
        document.getElementById('dividend-table').querySelectorAll('th').forEach(header => {
            header.addEventListener('click', function() {
                const column = this.getAttribute('data-column');
                if (column === sortColumn) {
                    sortDirection *= -1; // Inverse la direction
                } else {
                    sortColumn = column;
                    sortDirection = 1; // Trie par d√©faut en croissant sur la nouvelle colonne
                }
                renderTable();
            });
        });

        // Lance le chargement des donn√©es au d√©marrage
        fetchDividendData();
    </script>
</body>
</html>